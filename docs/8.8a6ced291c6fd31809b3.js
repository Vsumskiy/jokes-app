(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"m3+q":function(e,t,o){"use strict";o.r(t),o.d(t,"CreateJokeModule",(function(){return C}));var i=o("PCNd"),a=o("ofXK"),n=o("tyNb"),r=o("lJxs"),s=o("1uah"),c=o("LRne"),g=o("/ISb"),d=o("fXoL"),p=o("KvfK"),h=o("bN9u"),b=o("S9hJ"),u=o("ZGDG"),f=o("eq+F"),l=o("pDGf");function m(e,t){if(1&e&&(d.Ob(0),d.Mb(1,"app-favorite-card",7),d.Nb()),2&e){const e=d.bc();d.zb(1),d.hc("joke",e.joke)}}function k(e,t){1&e&&d.Mb(0,"app-empty-container",8)}let v=(()=>{class e{constructor(e,t,o){this.jokeService=e,this.jokesDataService=t,this.jokesMediaService=o,this.errorMessage="",this.loading=!1,this.categoriesList=[]}ngOnInit(){this.getCategories(),this.jokeService.removeBufferJoke()}getCategories(){this.jokesDataService.fetchCategories().subscribe(e=>{this.categoriesList=[...e]})}onNewJoke(e){this.loading=!0,Object(s.a)(this.postCategory(e),this.postIcon(e)).subscribe(t=>{const[o,i]=t;e.customCategories&&(e.categories=e.categories.map(e=>this.getCategoriesId(""+e)),e.categories.unshift(o)),e.image&&(e.imageNames=i),this.postJoke(e)})}postJoke(e){this.jokesDataService.postJoke(e).subscribe(e=>{this.jokeService.setBufferJoke(e),this.jokeService.currentBufferJoke.subscribe(e=>{this.joke=e}),this.jokesDataService.openSnackBar("Created!"),this.getCategories(),this.loading=!1},()=>this.jokesDataService.openSnackBar("Something went wrong...")).add(()=>{this.loading=!1})}postCategory(e){return e.customCategories?this.jokesDataService.postCategory(e.customCategories).pipe(Object(r.a)(e=>e.id)):Object(c.a)(null)}postIcon(e){if(!e.image)return Object(c.a)(null);const t=this.jokesMediaService.getImageInfo.map((t,o)=>this.jokesMediaService.putImage(e.image[o],t.imageUploadUrl));return Object(s.a)(...t).pipe(Object(r.a)(()=>this.jokesMediaService.getImageInfo.map(e=>e.imageName)))}getCategoriesId(e){var t;return null===(t=this.categoriesList.find(t=>t.title===e))||void 0===t?void 0:t.id}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(p.a),d.Lb(h.a),d.Lb(g.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["app-create-joke-page"]],features:[d.yb([g.a])],decls:8,vars:4,consts:[["title","Create Joke"],[1,"container"],[1,"form-container"],[3,"loadingState","categoryList","modifyOnJoke"],[1,"cards"],[4,"ngIf","ngIfElse"],["empty",""],[3,"joke"],["title","Create your first joke :)"]],template:function(e,t){if(1&e&&(d.Mb(0,"app-toolbar",0),d.Qb(1,"div",1),d.Qb(2,"div",2),d.Qb(3,"app-joke-modify-form",3),d.Xb("modifyOnJoke",(function(e){return t.onNewJoke(e)})),d.Pb(),d.Qb(4,"div",4),d.uc(5,m,2,1,"ng-container",5),d.Pb(),d.Pb(),d.Pb(),d.uc(6,k,1,0,"ng-template",null,6,d.vc)),2&e){const e=d.mc(7);d.zb(3),d.hc("loadingState",t.loading)("categoryList",t.categoriesList),d.zb(2),d.hc("ngIf",t.joke)("ngIfElse",e)}},directives:[b.a,u.a,a.l,f.a,l.a],styles:[".container[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{margin:0 auto;display:flex;justify-content:center}@media (max-width:600px){.container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{flex-direction:column;align-items:center}}.cards[_ngcontent-%COMP%]{height:80vh;overflow-y:auto;width:480px}.cards[_ngcontent-%COMP%]::-webkit-scrollbar{width:2px;height:2px}.cards[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{height:2px;background-color:#8ea7ff;border-radius:40px}@media (max-width:600px){.cards[_ngcontent-%COMP%]{width:100%}}"]}),e})();var j=o("Tk1w");let C=(()=>{class e{}return e.\u0275mod=d.Jb({type:e}),e.\u0275inj=d.Ib({factory:function(t){return new(t||e)},providers:[j.a],imports:[[a.c,i.a,n.e.forChild([{path:"",component:v,canActivate:[j.a]}])]]}),e})()}}]);